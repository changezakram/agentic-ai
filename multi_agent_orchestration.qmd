---
title: "Multi-Agent Orchestration in Banking: Building Intelligent Workflows at Scale"
format: html
toc: true
---

## Why Single Agents Aren't Enough 

A credit approval agent that operates in isolation isn't autonomous—it's blind. It can't see the compliance agent's sanctions screening, the pricing agent's market analysis, or the risk agent's portfolio exposure. The result: decisions made with incomplete context.

**Key Points:**
- Real banking workflows require 3-10 agents working together
- The coordination challenge: context sharing, state management, error handling, human escalation
- Why this matters NOW: LLMs can reason, but orchestration determines whether they're useful or chaotic

The question isn't whether to use multiple agents—it's how to orchestrate them.

---

## The Four Orchestration Patterns 

Frame each pattern with:
1. Pattern name + visual metaphor
2. Banking use case (specific, detailed)
3. When to use it
4. Governance consideration

### Pattern 1: Sequential Pipeline

**Metaphor:** Assembly line

**Use Case:** Consumer loan origination
- Application Intake Agent → Document Verification Agent → Credit Analysis Agent → Compliance Check Agent → Pricing Agent → Approval Agent
- **Detail the handoffs:** 
  - Application Intake extracts structured data from forms/documents 
  - Document Verification confirms income statements, IDs, credit reports 
  - Credit Analysis generates risk score + debt-to-income ratio 
  - Compliance runs sanctions screening + fair lending checks 
  - Pricing determines rate based on risk + market conditions 
  - Approval makes final decision within policy limits

**When to use:** Linear dependencies, each step requires previous step's output

**Governance:** Each agent logs decision + reasoning, human review triggers on exceptions (DTI > 43%, sanctions hit, rate outside policy bounds)

### Pattern 2: Parallel Fan-Out/Fan-In

**Metaphor:** Simultaneous investigations

**Use Case:** AML investigation (from Deloitte example)
- **Fan-out:** Alert triggers → 3 agents activate simultaneously:
  - Transaction Pattern Agent (analyzes velocity, structuring, round-dollar amounts)
  - Entity Analysis Agent (beneficial ownership, related parties, shell companies)
  - External Data Agent (adverse media, sanctions lists, PEP databases)
- **Fan-in:** All findings merge → Risk Scoring Agent assigns final suspicion score → Documentation Agent generates SAR if threshold exceeded

**When to use:** Independent analyses that can run concurrently

**Governance:** Each agent must complete before final decision, timeouts trigger human review

### Pattern 3: Hierarchical Supervisor-Worker

**Metaphor:** Orchestra conductor

**Use Case:** Treasury operations
- **Supervisor Agent:** Receives mandate (e.g., "Optimize liquidity for Q4 tax payment")
- **Delegates to workers:**
  - Cash Forecasting Agent (projects inflows/outflows across accounts)
  - FX Hedging Agent (analyzes currency exposure, recommends hedges)
  - Investment Agent (suggests short-term investment vehicles for excess cash)
  - Regulatory Reporting Agent (ensures liquidity coverage ratio compliance)
- **Supervisor:** Aggregates recommendations, resolves conflicts (e.g., invest vs. hedge), executes coordinated plan

**When to use:** Complex workflows requiring dynamic task allocation, conflicting objectives

**Governance:** Supervisor maintains audit trail of delegation decisions, workers cannot execute without supervisor approval

### Pattern 4: Event-Driven Reactive

**Metaphor:** Smoke alarm

**Use Case:** Autonomous mortgage refinancing
- **Trigger:** Fed rate cut detected
- **Agent cascade:**
  - Market Monitoring Agent → triggers Eligibility Agent (identifies customers with rates >X% above new market rate)
  - Portfolio Agent → assesses bank's capacity to refinance (balance sheet, servicing capacity)
  - Offer Generation Agent → creates personalized offers for eligible customers
  - Notification Agent → sends offers via customer's preferred channel
  - Follow-up Agent → tracks responses, schedules advisor calls

**When to use:** Continuous monitoring, opportunistic workflows

**Governance:** Rate limits (max offers/day), exposure limits (max refinance volume), mandatory human approval for high-value customers

> **Key Insight:** Most banks will use ALL four patterns simultaneously. Consumer lending runs sequential pipelines. Risk management uses parallel fan-out. Treasury uses hierarchical coordination. Customer lifecycle management uses event-driven triggers. The orchestration layer must support all four.

---

## Model Context Protocol - The Agent Language 

**Opening:**
Agents need a common language. Without it, Agent A's output becomes garbage to Agent B.

### What MCP Solves

- **Context Sharing:** Agent A's analysis (unstructured text) → structured data Agent B can reason over
- **Tool Invocation:** Agent B requests Agent C to run sanctions check → receives results in standardized format
- **State Management:** Workflow pauses (customer uploads additional doc) → resumes exactly where it left off

### MCP vs. Traditional APIs

| Traditional API | MCP |
|-----------------|-----|
| Data transfer | **Context transfer** |
| "Here's a JSON blob" | **"Here's what I learned, why it matters, what's uncertain"** |
| Static schemas | **Semantic understanding** |
| Point-to-point | **Many-to-many agent communication** |


### Why This Matters

- Without MCP: Each vendor's agents speak different dialects → integration nightmare
- With MCP: Plug-and-play agent networks, vendor interoperability

### Current State

- MCP still emerging (Anthropic released spec Nov 2024)
- Not yet industry standard, but momentum building
- Banks should evaluate MCP support when selecting agent platforms

---

## Orchestration Architecture - The Control Center 

Frame as **"The Banking Orchestration Stack"** - 4 layers:

### Layer 1: Workflow Engine

- Defines agent sequences, parallelism, conditionals
- Banking requirement: Handle long-running workflows (loan application takes days/weeks, not minutes)
- Must support: Human-in-loop pauses, external event triggers (customer uploads doc), deadline management (regulatory timelines)

### Layer 2: Context Broker

- Manages data flow between agents
- Banking requirement: Enforce data access controls (credit agent can't see full SSN, only masked version)
- Must track: Data lineage (which agent saw what data, when), consent management (customer approved data sharing)

### Layer 3: State Management

- Tracks workflow progress, maintains context across sessions
- Banking requirement: Persist state for audit (7-year retention for loan decisions)
- Must support: Workflow rollback (cancel loan application mid-stream), partial restarts (re-run compliance after new info)

### Layer 4: Monitoring & Observability

- Real-time dashboards: Active workflows, agent performance, error rates
- Banking requirement: Detect regulatory violations in real-time (fair lending disparities, data retention breaches)
- Must alert on: Stuck workflows (>SLA), anomalous patterns (sudden spike in denials), agent drift (performance degradation)

### Error Handling - Banking-Specific

- **Transient failures:** Retry with exponential backoff (API timeout, temporary data unavailable)
- **Permanent failures:** Route to human queue (agent can't determine income verification method)
- **Regulatory exceptions:** Immediate escalation + workflow pause (OFAC hit, fair lending flag)

### Integration Points

- **Upstream:** Core banking systems (deposits, loans, CRM)
- **Downstream:** Agent platforms (Bedrock, Salesforce, custom)
- **Sidecar:** Compliance systems (model risk management, audit logs)

---

## Deep-Dive Use Case - Corporate Loan Origination 

**Scenario:**
"Supremo Corporation applies for €50M credit facility for European expansion. The orchestration system coordinates 7 agents across 3 departments over 5 business days."

### Act 1: Data Gathering (Parallel)

- **Application Intake Agent** extracts structured data from PDF application
- **Financial Statement Agent** ingests 3 years of audited financials
- **Market Research Agent** pulls economic data on target European markets
- All three run in parallel, fan-in when complete

### Act 2: Analysis (Sequential Pipeline)

- **Credit Analysis Agent** receives fan-in results → generates risk score, leverage ratios, cash flow projections
- **Industry Benchmarking Agent** compares Supremo to peer companies → identifies outliers
- **Credit Memo Agent** drafts preliminary write-up with analysis + data citations

### Act 3: Compliance & Risk (Parallel with Hierarchical)

- **Sanctions Screening Agent** checks Supremo + all beneficial owners against OFAC/EU lists
- **Country Risk Agent** assesses political/economic stability of target markets
- **Concentration Risk Agent** checks bank's existing exposure to Supremo's industry/geography
- **Supervisor Agent** aggregates all risk flags → escalates to human if any red flags

### Act 4: Pricing & Structuring (Sequential)

- **Pricing Agent** determines rate based on: credit risk score, market conditions, relationship value, concentration risk premium
- **Structuring Agent** recommends covenants, collateral requirements, amortization schedule
- **Profitability Agent** calculates risk-adjusted return on capital (RAROC) → flags if below hurdle rate

### Act 5: Documentation & Approval (Event-Driven)

- **Approval Routing Agent** determines approval authority (€50M requires C-suite, board notification)
- **Document Generation Agent** produces credit agreement, term sheet, compliance certifications
- **Notification Agent** alerts relationship manager, client, credit committee

### Human Touchpoints

- Credit officer reviews Credit Memo Agent output (augments with relationship context)
- Chief Credit Officer approves final terms (agent recommendation + override authority)
- Relationship manager negotiates final terms with client (agents provide real-time pricing scenarios)

### Orchestration Complexity

- 7 agents, 23 discrete tasks, 4 decision points, 3 human reviews
- Without orchestration: 3-4 weeks, 15-20 emails, multiple spreadsheets, version control chaos
- With orchestration: 5 days, 2 human meetings, single source of truth, full audit trail

### Governance Audit Trail

```
[Agent: Credit Analysis] Input: Financials, Market Data | Output: Risk Score 6.2/10 | Reasoning: "Strong cash flow offset by high leverage (3.2x)"
[Agent: Pricing] Input: Risk Score 6.2 | Output: Rate SOFR + 275bps | Reasoning: "Peer average SOFR + 250, +25 for concentration risk"
[Human: Chief Credit Officer] Override: Rate SOFR + 250bps | Reasoning: "Strategic relationship, waive concentration premium"
```

---

## Governance for Multi-Agent Systems 

Focus ONLY on **orchestration-specific governance** (different from single-agent governance in Blog 1)

### New Governance Requirements

#### 1. Agent Dependency Mapping

- Which agents rely on which other agents?
- What happens if Agent B is unavailable when Agent A needs it?
- Fallback chains: Primary agent → Backup agent → Human escalation

#### 2. Inter-Agent Permission Model

- Agent A can invoke Agent B for sanctions screening BUT NOT for credit decisions
- Prevents agents from "social engineering" each other (Agent A tricks Agent B into approving something outside policy)

#### 3. Workflow-Level Audit

- Beyond individual agent logs (covered in Blog 1)
- End-to-end workflow trace: Every handoff, every decision, every data transformation
- Regulatory requirement: "Show me how you reached the denial decision across all 7 agents"

#### 4. Orchestration Testing

- Unit tests: Individual agents work correctly
- Integration tests: Agents hand off properly (Agent A's output format matches Agent B's input requirements)
- Chaos tests: Kill Agent C mid-workflow → does orchestration recover gracefully or crash?
- Bias tests: Do multi-agent workflows produce fair lending violations at portfolio scale?

#### 5. Version Control

- Agent A v1.2 works with Agent B v2.0 but NOT v1.8
- Orchestration layer manages compatibility matrix
- Controlled rollouts: Deploy Agent A v1.3 to 10% of workflows, monitor for errors, rollback if needed

### Comparison: Single Agent vs. Multi-Agent Governance

| Governance Aspect | Single Agent (Blog 1) | Multi-Agent Orchestration (This Blog) |
|-------------------|----------------------|--------------------------------------|
| Risk focus | Agent makes wrong decision | Agents don't communicate properly → wrong decision |
| Audit trail | Agent decision log | Full workflow trace across agents |
| Testing | Model validation | Integration + chaos engineering |
| Permissions | What data can agent access | What other agents can this agent invoke |

---

## Vendor Landscape & Build vs. Buy 

### The Build vs. Buy Decision Matrix

| Factor | Platform (Buy) | Custom Framework (Build) |
|--------|---------------|-------------------------|
| **Time to production** | 3-6 months | 9-18 months |
| **Orchestration complexity** | Limited to platform patterns | Full flexibility |
| **Vendor lock-in risk** | High | None |
| **Ongoing maintenance** | Vendor handles | Your team owns |
| **Banking-specific features** | Generic workflows | Tailored to your processes |
| **Regulatory compliance** | Vendor's responsibility (but you're still accountable) | Fully under your control |

### Platform Solutions (Buy)

#### ServiceNow AI Platform
- **Strength:** Cross-vendor orchestration (any agent, any model)
- **Banking fit:** Strong for IT service management workflows, weaker for core banking
- **Governance:** Built-in audit trails, approval workflows
- **Consideration:** Heavy enterprise licensing, steep learning curve

#### Amazon Bedrock (Multi-Agent Collaboration)
- **Strength:** Native AWS integration, scales to high volume
- **Banking fit:** Good for cloud-native banks, harder for on-prem hybrid
- **Governance:** CloudWatch monitoring, IAM for agent permissions
- **Consideration:** Locked into AWS ecosystem

#### Salesforce Agentforce
- **Strength:** Pre-built banking agents (wealth management, service, sales)
- **Banking fit:** Excellent for CRM-centric workflows (relationship management, servicing)
- **Governance:** Salesforce Shield for audit compliance
- **Consideration:** Weak for core banking processes (loans, deposits, payments)

### Custom Frameworks (Build)

#### LangGraph (Open Source)
- **Strength:** Maximum flexibility, agent-as-code
- **Banking fit:** Can model any banking workflow
- **Governance:** You build all controls yourself
- **Consideration:** Requires strong ML engineering team

#### Microsoft Semantic Kernel
- **Strength:** Language-agnostic (C#, Python, Java), enterprise integration
- **Banking fit:** Works with Azure AI services + on-prem systems
- **Governance:** Integrate with your existing compliance tools
- **Consideration:** Less mature than LangGraph, smaller community

### Decision Framework for Banks

**Start with Platform IF:**
- You're prioritizing speed to market (pilot in 3-6 months)
- You have standard workflows (consumer lending, servicing)
- You lack ML engineering capacity

**Build Custom IF:**
- You have unique competitive workflows
- You have strong ML engineering team
- You need full regulatory control
- You're making multi-decade infrastructure investment

**Hybrid Approach (Recommended):**
- Use platform for Experience Agents (customer-facing, low risk)
- Build custom for Domain Agents (core banking, high risk, competitive differentiation)
- Orchestration layer connects both

---


## Common Pitfalls to Avoid

- ❌ Starting with most complex workflow → Start simple, prove orchestration value
- ❌ Over-engineering governance upfront → Implement minimum controls, iterate
- ❌ Ignoring monitoring → You can't improve what you don't measure
- ❌ Treating orchestration as IT project → This is business process transformation, needs business owners
